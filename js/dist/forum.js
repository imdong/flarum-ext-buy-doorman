(()=>{var o={n:e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},d:(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(o,e)=>Object.prototype.hasOwnProperty.call(o,e),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},e={};(()=>{"use strict";o.r(e),o.d(e,{extend:()=>_});const t=flarum.core.compat["common/app"];o.n(t)().initializers.add("imdong/flarum-ext-buy-doorman",(function(){console.log("[imdong/flarum-ext-buy-doorman] Hello, forum and admin!")}));const n=flarum.core.compat["forum/app"];var r=o.n(n);const a=flarum.core.compat["common/extend"],s=flarum.core.compat["forum/components/IndexPage"];var i=o.n(s);const c=flarum.core.compat["common/components/LinkButton"];var l=o.n(c);const u=flarum.core.compat["common/extenders"];var d=o.n(u);function p(o,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,e){return o.__proto__=e,o},p(o,e)}function f(o,e){o.prototype=Object.create(e.prototype),o.prototype.constructor=o,p(o,e)}const y=flarum.core.compat["common/helpers/listItems"];var v=o.n(y);const b=flarum.core.compat["common/components/Button"];var h=o.n(b);const g=flarum.core.compat["common/components/Modal"];var x=o.n(g);const N=flarum.core.compat["common/utils/Stream"];var O=o.n(N),P=function(o){function e(){var e;return(e=o.call(this)||this).email=void 0,e.email=O()(),e}f(e,o);var t=e.prototype;return t.className=function(){return"store-buy Modal--small"},t.title=function(){return"购买邀请码"},t.content=function(){return m("div",{className:"container buy-store-layer"},m("div",{className:"Form"},m("div",{class:"helpText"},"将花费 100 药丸，购买一个注册邀请码，并发送到“受邀人邮箱”中。"),m("div",{class:"Form-group"},m("label",{for:"buy-store-to-mail"},"受邀人邮箱"),m("div",{class:"helpText"},"邀请码购买成功后，将通过邮件发送到受邀人邮箱中。"),m("input",{required:!0,id:"buy-store-to-mail",class:"FormControl",type:"email",bidi:this.email})),h().component({className:"Button Button--primary",type:"submit",loading:this.loading},"购买 & 发送")))},t.onsubmit=function(o){var e=this;o.preventDefault(),this.loading=!0,r().request({method:"POST",url:r().forum.attribute("apiUrl")+"/store/buy-doorman",body:{email:this.email()}}).then((function(o){console.log("result",o),e.loading=!1,r().alerts.show({type:"success"},"发送成功"),e.email(""),e.hide();var t=r().session.user.attribute("money");console.log("money",t,o),r().session.user.pushAttributes({money:t-o.data.attributes.use_money})}))},e}(x()),S=function(o){function e(){return o.apply(this,arguments)||this}f(e,o);var t=e.prototype;return t.oncreate=function(e){o.prototype.oncreate.call(this,e),r().setTitle("小药店"),r().setTitleCount(0)},t.view=function(){return m("div",{className:"IndexPage"},m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,v()(this.sidebarItems().toArray()))),m("div",{className:"StorePage-results sideNavOffset"},m("h2",{class:"BadgeOverviewTitle"},"小药店"),m("div",{className:"Store-Body"},m(h(),{className:"Button Button--primary",onclick:function(){r().modal.show(P)}},"购买邀请码"))))))},e}(i());const _=[(new(d().Routes)).add("imdong.buy-doorman.store.index","/store",S)];(0,a.extend)(i().prototype,"navItems",(function(o){o.add("buy-doorman-store",m(l(),{href:r().route("imdong.buy-doorman.store.index"),icon:"fas fa-store"},"小药店"),0)}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map